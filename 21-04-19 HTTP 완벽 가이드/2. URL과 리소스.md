## 2. URL과 리소스

- URL(Uniform Resource Locator): 인터넷의 리소스를 가리키는 표준 이름. 전자정보 일부를 가리키고 그것이 어디에 있고 어떻게 접근할 수 있는지 알려준다.

#### 2.1 인터넷의 리소스 탐색하기

- URL
  - 브라우저가 정보를 찾는데 필요한 리소스의 위치
  - 통합 자원 식별자(Uniform Resource Identifier) 혹은 URI라고 불리는 더 일반화된 부류의 부분집합
  - URN은 현재 그 리소스가 어디에 존재하든 상관없이 그 이름만으로 리소스를 식별하는데 비해 URL은 리소스가 어디 있는지 설명해서 리소스를 식별한다.
  - HTTP 명세에서는 URI를 더 일반화된 개념의 리소스 식별자로 사용한다. 하지만 실제로 HTTP 애플리케이션은 URL을 URI의 한 부분으로 취급한다.

1. URL 문법

   - URL로 인터넷상의 모든 리소스를 찾을 수 있지만, 그 리소스들은 다른 스킴(HTTP, FTP, SMTP)을 통해 접근할 수 있으며, URL 문법은 스킴에 따라 달라진다.

   - ```
     <스킴>://<사용자이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의>#<프래그먼트>
     ```

     - 가장 중요한 컴포넌트: 스킴, 호스트, 경로
     - 스킴: 리소스를 가져오려면 어떤 프로토콜을 사용하여 서버에 접근해야 하는지 가리킨다. (기본값 없음)
     - 사용자 이름: 몇몇 스킴은 리소스에 접근을 하기 위해 사용자 이름을 필요로 한다. (기본값 anonymous)
     - 비밀번호: 사용자의 비밀번호를 가리키며, 사용자 이름에 콜론(:)으로 이어서 기술한다. (기본값 <이메일 주소>)
     - 호스트: 리소스를 호스팅하는 서버의 호스트 명이나 IP 주소. (기본값 없음)
     - 포트: 리소스를 호스팅하는 서버가 열어놓은 포트번호. 많은 스킴이 기본 포트를 가지고 있다. HTTP의 기본 포트는 80. (기본값 스킴에 따라 다름)
     - 경로: 이전 컴포넌트와 빗금(/)으로 구분되어 있으며, 서버 내 리소스가 서버 어디에 있는지를 가리킨다. 경로 컴포넌트의 문법은 서버와 스킴에 따라 다르다. (기본값 없음)
     - 파라미터: 특정 스킴들에서 입력 파라미터를 기술하는 용도로 사용한다. 파라미터는 이름/값을 쌍으로 가진다. 파라미터는, 다른 파라미터나 경로의 일부와 세미콜론(;)으로 구분하여 기술하며, 여러 개를 가질 수 있다. (기본값 없음)
     - 질의: 스킴에서 애플리케이션(데이터베이스, 게시판, 검색엔진, 기타 인터넷 게이트웨이)에 파라미터를 전달하는데 쓰인다. 질의 컴포넌트를 작성하는데 쓰이는 공통 포멧은 없다. 이는 URL의 끝에 "?"로 구분한다. (기본값 없음)
     - 프래그먼트: 리소스의 조각이나 일부분을 가리키는 이름이다. URL이 특정 객체를 가리킬 경우에 프래그먼트 필드는 서버에 전달되지 않는다. 이는 클라이언트에서만 사용한다. URL의 끝에서 "#" 문자로 구분한다. (기본값 없음)

   1. 스킴
      - 주어진 리소스에 어떻게 접근하는지 알려주는 중요한 정보. URL을 해석하는 애플리케이션이 어떤 프로토콜을 사용하여 리소스를 요청해야 하는지 알려준다.
      - 알파벳으로 시작해야 하고 URL의 나머지 부분들과 첫 번째 ':' 문자로 구분한다.
      - 대소문자를 가리지 않으므로 HTTP와 http는 같다.
   2. 호스트와 포트
      - 애플리케이션이 인터넷에 있는 리소스를 찾으려면, 리소스를 호스팅하고 있는 장비와 그 장비 내에서 리소스에 접근할 수 있는 서버가 어디에 있는지 알아야 한다. URL의 호스트와 포트 컴포넌트는 그 두 가지 정보를 제공해준다.
      - 호스트 컴포넌트는 접근하고자 하는 리소스를 가지고 있는 인터넷상의 호스트 장비를 가리킨다. 해당 값은 호스트 명이나 IP 주소로 제공한다.
        - www.joes-hardware.com
        - 161.58.228.45
      - 포트 컴포넌트는 서버가 열어놓은 네트워크 포트를 가리킨다. 내부적으로 TCP 프로토콜을 사용하는 HTTP는 기본 포트로 80을 사용한다.
   3. 사용자 이름과 비밀번호
      - 많은 서버가 자신이 가지고 있는 데이터에 접근을 허용하기 전에 사용자 이름과 비밀번호를 요구한다.
      - 사용자 이름과 비밀번호 값이 삽입되어 있지 않을 경우 기본 사용자 이름과 비밀번호 값을 넣어놓을 것이다.
        - 사용자 이름: anonymous
        - 비밀번호: 브라우저마다 상이, 인터넷 익스플로러 IEUser, 크롬 chrome@example.com
   4. 경로
      - 리소스가 서버의 어디에 있는지 알려준다. 계층적 파일 시스템 경로와 유사한 구조를 갖는다.
      - '/' 문자를 기준으로 경로조각으로 나뉜다. 각 경로조각은 자체만의 파라미터 컴포넌트를 가질 수 있다.
   5. 파라미터
      - 많은 스킴이 객체에 대한 호스트 및 경로 정보 만으로는 리소스를 찾지 못한다. 서버가 어떤 포트를 열어놓고 있는지, 리소스에 접근하기 위해 사용자 이름과 비밀번호를 명시했는지 여부 외에도 많은 프로토콜이 더 많은 정보를 요구한다.
      - URL을 사용하는 애플리케이션이 리소스에 접근하려면 프로토콜 파라미터가 필요하다. 프로토콜 파라미터가 없으면, 다른 한편에 있는 서버는 그 요청을 잘못 처리하거나 처리를 하지 않을 것이다.
      - 애플리케이션이 서버에 정확한 요청을 하기 위해 필요한 입력 파라미터를 받는데 사용한다. 이 컴포넌트는 이름/값 쌍의 리스트로 URL 나머지 부분들로부터 ';' 문자로 구분하여 URL에 기술한다.이를 통해 애플리케이션이 리소스에 접근하는데 필요한 어떤 추가 정보든 전달할 수 있다.
   6. 질의 문자열
      - DB와 같은 서비스에서 요청받을 리소스 형식의 범위를 좁히기 위해 사용
      - 게이트웨이를 가리키는 URL의 경로 컴포넌트와 함께 전달
        - 게이트웨이: 다른 애플리케이션에 접근하려고 할 때 거치는 통로
      - 편의상 많은 게이트웨이가 '&'로 나뉜 '이름=값' 쌍 형식의 질의 문자열을 원한다.
      - `item=1234&color=blue`
   7. 프래그먼트
      - 리소스의 특정 부분을 가리키기 위해 사용
      - \# 문자에 이어서
      - 일반적으로 HTTP 서버는 객체 일부가 아닌 전체만 다루기 때문에, 클라이언트는 서버에 프래그먼트를 전달하지 않는다. 브라우저가 서버로부터 전체 리소스를 내려받은 후, 프래그먼트를 사용하여 보고자하는 리소스의 일부를 보여준다.

#### 2.2 단축 URL

1. 상대 URL

   - 절대 URL은 리소스에 접근하는데 필요한 모든 정보를 가지고 있지만, 상대 URL은 그렇지 않다.
   - 기저(base)라고 하는 다른 URL을 사용해 리소스에 접근하는데 필요한 모든 정보를 얻는다.
   - URL을 짧게 표기하는 방식
   - 프래그먼트이거나 URL 일부
   - 리소스 집합(HTML 페이지 같은)을 쉽게 변경할 수 있다.
   - 문서 집합의 위치를 변경하더라도, 새로운 기저 URL에 의해 해석될 것이기 때문에 위치를 변경하더라도 잘 동작할 것이다.

   - URL을 처리하는 브라우저 같은 애플리케이션은 상대 URL과 절대 URL 간에 상호 변환을 할 수 있어야 한다.
     - *기저 URL*
       - 상대 URL의 기준
       - 가져오는 방법
         - 리소스에서 명시적으로 제공
         - 리소스를 포함하고 있는 기저 URL: 상대 URL이 기저 URL이 명시되지 않은 리소스에 포함된 경우, 해당 리소스의 URL을 기저 URL로 쓸 수 있다.
         - 기저 URL이 없는 경우: 절대 URL만으로 이루어져 있거나 불완전하거나 깨진 URL일 수 있다.
     - *상대 참조 해석하기*
       - URL 분해하기, URL 파싱
       - 알고리즘을 통해 상대 URL을 절대 URL로 변환할 수 있다. (P. 39 참조)
   
2. URL 확장
   1. 호스트 명 확장
      - 단순한 휴리스틱만을 사용해서 입력한 호스트 명을 전체 호스트 명으로 확장할 수 있다.
   2. 히스토리 확장
      - 과거에 사용자가 방문했던 URL의 기록으로 확장할 수 있다.
   
3. 안전하지 않은 문자
   - 안전한 전송: 정보가 유실될 위험 없이 URL을 전송할 수 있다.
   - SMTP(Simple Mail Transfer Protocol)같은 프로토콜은 특정 문자를 제거할 수도 있는 전송 방식을 사용한다. 문자가 제거되는 일을 피하고자 URL은 상대적으로 작고 일반적으로 안전한 알파벳 문자만 포함하도록 허락한다.
   - 이스케이프라는 기능을 추가하여, 안전하지 않은 문자를 안전한 문자로 인코딩할 수 있게 하였다.

   1. URL 문자 집합

      - 보통 영어 중심
      - US-ASCII
        - 문자를 서식화하고 하드웨어상에서 신호를 주고받기 위해, 7비트를 사용하여 영문 자판에 있는 키 대부분과 몇몇 출력되지 않는 제어 문자를 표현한다.
        - 적은 수의 문자만을 포함하고 있어 유럽 언어나 비 라틴계 언어에 존재하는 변형된 문자들을 지원하지 않음
        - 이스케이프 문자열 사용이 금지되어, 특정 문자나 데이터를 인코딩할 수 있게 함으로써 이동성과 완성도를 높였다.

   2. 인코딩 체계

      - 안전한 문자 집합을 이용하는 경우 그 표현의 한계를 넘기 위해, URL에 있는 안전하지 않은 문자들을 표현할 수 있는 인코딩 방식이 고안되었다.
      - 인코딩은 안전하지 않은 문자를 퍼센티지 기호(%)로 시작해, ASCII 코드로 표현되는 두 개의 16진수 숫자로 이루어진 '이스케이프' 문자로 바꾼다.

   3. 문자 제한

      - 예약된 문자들을 본래의 목적이 아닌 다른 용도로 사용하려면, 그전에 반드시 인코딩해야 하는 문자

        | 문자               | 선점 및 제한                                                 |
        | ------------------ | ------------------------------------------------------------ |
        | %                  | 인코딩된 문자에 사용할 이스케이프 토큰으로 선점              |
        | /                  | 경로 컴포넌트에 있는 경로 세그먼트를 나누는 용도로 선점      |
        | .                  | 경로 컴포넌트에서 선점                                       |
        | ..                 | 경로 컴포넌트에서 선점                                       |
        | #                  | 프래그먼트의 구획 문자로 선점                                |
        | ?                  | 질의 문자열의 구획 문자로 선점                               |
        | ;                  | 파라미터의 구획 문자로 선점                                  |
        | $ , +              | 선점                                                         |
        | @ & =              | 특정 스킴에서 특별한 의미가 있기 때문에 선점                 |
        | { } \| \ . ~ [ ] ` | 게이트웨이와 같은 여러 전송 에이전트에서 불안전하게 다루기 때문에 제한됨 |
        | < > "              | 안전하지 않음. 웹 문서에서 URL을 구분 지어 표시하듯이, URL 범위 밖에서 역할이 있는 문자이기 때문에 반드시 인코딩해야 한다. |
        | 0x00-0x1F, 0x7F    | 제한됨, 이 16진수 범위에 속하는 문자들은 인쇄되지 않는 US-ASCII 문자다. |
        | > 0x7F             | 제한됨, 이 16진수 범위에 속하는 문자들은 7비트 US-ASCII 문자가 아니다. |

   4. 좀 더 알아보기

      - 안전하지 않은 모든 문자를 인코딩하기만 하면, 다른 애플리케이션으로부터 특별한 의미를 가지는 문자를 받았을 때 혼동할 걱정 없이, 애플리케이션 간에 공유할 수 있는 URL의 원형을 유지할 수 있다.
      - 입력받은 URL에서 어떤 문자를 인코딩해야 하는지 결정하는 데는 브라우저와 같이 사용자로부터 최초로 URL을 입력받는 애플리케이션에서 하는 것이 가장 적절하다.
      - 모든 문자를 인코딩하는 것은 오동작을 일으킬 수 있다.
      - 스킴 같은 몇몇 URL 컴포넌트는 쉽게 알아볼 수 있어야 하며 알파벳 문자로 시작되어야 한다.

4. 스킴의 바다

   - 일반 스킴들의 포맷

     | 스킴        | 설명                                                         |
     | ----------- | ------------------------------------------------------------ |
     | http        | 사용자 이름이나 비밀번호가 없다는 것을 제외하고는, 일반 URL 포맷을 지키는 하이퍼텍스트 전송 프로토콜(Hypertext Transfer Protocol) 스킴이다. 포트값이 생략되어 있으면 기본값은 80이다.<br />기본형식: `http://<호스트>:<포트>/<경로>?<질의>#<프래그먼트>` |
     | https       | https 스킴은 http 스킴과 거의 같다. 다른 점이라고는 https는 HTTP의 커넥션의 양 끝단에서 암호화하기 위해 넷스케이프에서 개발한 보안 소켓 계층(Secure Sockets Layer, SSL)을 사용한다는 것뿐이다. 문법은 HTTP와 같고 기본 포트값은 443이다.<br />기본형식: `http://<호스트>:<포트>/<경로>?<질의>#<프래그먼트>` |
     | mailto      | mailto URL은 이메일 주소를 가리킨다. 이메일은 다른 스킴과는 다르게 동작하기 때문에, mailto URL은 표준 URL과는 다른 포맷을 가진다. 인터넷 이메일 주소의 문법은 RFC 822에 기술되어 있다.<br />기본형식: `mailto:<RFC-822-addr-spec>` |
     | ftp         | 파일 전송 프로토콜(File Transfer Protocol) URL은 FTP 서버에 있는 파일을 내려 받거나 올리고, FTP 서버의 디렉터리에 있는 콘텐츠 목록을 가져오는 데 사용할 수 있다.<br />FTP는 웹과 URL이 출현하기 전부터 있었다. 웹 애플리케이션은 데이터에 접근하는 용도의 스킴으로 FTP를 사용한다. URL 문법은 다음과 같이 일반적인 URL 포맷이다.<br />기본형식: `ftp://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>:<파라미터>` |
     | rtsp, rtspu | RTSP URL은 실시간 스트리밍 프로토콜(Real Time Streaming Protocol)을 통해서 읽을 수 있는 오디오 및 비디오와 같은 미디어 리소스 식별자다.<br />rtspu 스킴에 있는 'u'는 리소스를 읽기 위해서 UDP 프로토콜이 사용됨을 뜻한다.<br />기본형식: <br />`rtsp://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>`<br />`rtspu://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>` |
     | file        | file 스킴은 주어진 호스트 기기(로컬 디스크, 네트워크 파일 시스템 혹은 기타 파일 공유 시스템)에서 바로 접근할 수 있는 파일들을 나타낸다. 각 필드도 일반적인 URL 포맷을 따른다. 만약 호스트가 생략되어 있으면, URL을 사용하고 있는 기기의 로컬 호스트가 기본값이 된다.<br />기본형식: `file://<호스트>/<경로>` |
     | news        | news 스킴은 RFC 1036에 정의된 바와 같이 특정 문서나 뉴스 그룹에 접근하는데 사용한다. news URL은 리소스의 위치 정보를 충분히 포함하지 않는 특이한 속성이 있다. news URL은 해당 리소스가 어디에 있는지에 대한 정보를 포함하지 않는다. 호스트 명이나 서버 이름도 제공하지 않는다. 사용자로부터 그 정보를 알아내는 것은 애플리케이션의 몫이다. 뉴스 리소스는 여러 서버를 통해 접근할 수 있다. 뉴스 리소스에 접근하는 것이 하나의 서버로만 접근할 수 있는 게 아니므로, 위치에 독립적이라고 할 수 있다.<br />news URL에서 선점한 '@' 문자는 뉴스 그룹을 가리키는 뉴스 URL과 특정 뉴스 문서를 가리키는 뉴스 URL을 구분하기 위해 사용된다.<br />기본형식:<br />`news:<newsgroup>`<br />`news:<news-article-id>` |
     | telnet      | telnet 스킴은 대화형 서비스에 접근하는데 사용한다. telnet URL 자체가 객체를 가리키지는 않지만, 리소스라고 할 수 있는 대화형 애플리케이션은 이 telnet 프로토콜을 통해 접근할 수 있다.<br />기본형식:<br />`telnet://<사용자이름>:<비밀번호>@<호스트>:<포트>/` |
     |             |                                                              |
     |             |                                                              |

5. 미래

   - URL은 주소이지 실제 이름은 아니다. URL이 특정 시점에 어떤 것이 위치한 곳을 알려준다는 것을 뜻한다.

     → 리소스가 옮겨지면 URL을 더는 사용할 수 없다. 그리고 그 시점에 기존 URL이 가리키고 있던 객체를 찾을 방법이 없어진다.

     → 객체의 위치와 상관없이, 그 객체를 가리키는 실제 객체의 이름을 사용하면 위치가 바뀌더라도 리소스의 위치를 찾을 수 있다.

     → **URN(Uniform Resource Names)**

     	- 인터넷 기술 태스크 포스(Internet Engineering Task Force, IEFT)에서 제정
     	- 개체가 옮겨지더라도 (웹 서버 내에서나 웹 서버 간 모두) 항상 객체를 가리킬 수 있는 이름을 제공한다.
     	- 지속 통합 자원 지시자(Persistent uniform resource locators, PURL)을 사용하면 URL로 URN의 기능을 제공할 수 있다. PURL은 리소스의 실제 URL 목록을 관리하고 추적하는 리소스 위치 중개 서버를 두고, 해당 리소스를 우회적으로 제공한다.