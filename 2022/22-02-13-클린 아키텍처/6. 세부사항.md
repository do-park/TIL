# 6. 세부사항

### 30. 데이터베이스는 세부사항이다

#### 관계형 데이터베이스

#### 데이터베이스 시스템은 왜 이렇게 널리 사용되는가

- 지난 반세기 동안 회전식 자기 디스크magnetic disk는 데이터 저장소의 중심에 있었다. 디스크 기술이 지닌 치명적인 한계는 느리다는 특성.
- 디스크의 시간 지연을 완화하기 위해 색인, 캐시, 쿼리 계획 최적화가 필요(데이터 접근 및 관리 시스템 필요)
  - 파일 시스템, 관계형 데이터베이스 관리 시스템(RDBMS)

#### 디스크가 없다면 어떻게 될까?

- 데이터를 무수히 많은 데이터 구조로 체계화 하고, 데이터에 접근할 때 포인터나 참조를 사용할 것
- 이미 데이터가 데이터베이스나 파일 시스템에 있더라도, RAM으로 읽은 후에는 다루기 편리한 형태로 그 구조를 변경한다. 

#### 세부사항

- 데이터베이스는 그저 메커니즘에 불과하다

#### 하지만 성능은?

- 데이터 저장소의 측면에서 성능은 완전히 캡슐화하여 업무 규칙과는 분리할 수 있는 관심사
- 이 관심사는 저수준의 데이터 접근 메커니즘 단에서 다룰 수 있다.



### 31. 웹은 세부사항이다

- GUI는 세부사항이다. 웹은 GUI다. 따라서 웹은 세부사항이다. 그리고 아키텍트라면 이러한 세부사항을 핵심 업무 로직에서 분리된 경계 바깥에 두어야 한다.



### 32. 프레임워크는 세부사항이다

#### 위험 요인

- 프레임워크의 아키텍처는 그다지 깔끔하지 않은 경우가 많다. 프레임워크는 의존성 규칙을 위반하는 경향이 있다.
- 프레임워크는 애플리케이션의 초기 기능을 만드는 데는 도움이 될 것이다. 하지만 제품이 성숙해지면서 프레임워크가 제공하는 기능과 틀을 벗어나게 될 것이다.
- 프레임워크는 당신에게 도움되지 않는 방향으로 진화할 수도 있다.
- 새롭고 더 나은 프레임 워크가 등장해서 갈아타고 싶을 수 있다.

#### 해결책

- 프레임워크가 핵심 코드 안으로 들어오지 못하게 하라. 대신 핵심 코드에 플러그인할 수 있는 컴포넌트에 프레임워크를 통합하고, 의존성 규칙을 준수하라.



### 33.  사례 연구: 비디오 판매



### 34. 빠져 있는 장

#### 계층 기반 패키지

- 전통적인 수평 계층형 아키텍처
- 기술적인 관점에서 해당 코드가 하는 일에 기반해 그 코드를 분할한다.

#### 기능 기반 패키지

- 서로 연관된 기능, 도메인 개념, 또는 Aggregate Root에 기반해 수직의 얇은 조각으로 코드를 나누는 방식
  - Aggregate는 데이터 변경의 단위로 다루는 연관 객체의 묶음, 모든 Aggregate는 Root을 가지며, 외부에서 객체에 접근할 때는 반드시 Aggregate Root을 통해야 한다.

#### 포트와 어댑터

- 포트와 어댑터Ports and Adapters 혹은 육각형 아키텍처Hexagonal Architecture, 경계, 컨트롤러, 엔티티BCE 등의 방식으로 접근하는 이유는 업무/도메인에 초점을 둔 코드가 프레임워크나 데이터베이스 같은 기술적인 세부 구현과 독립적이며 분리된 아키텍처를 만들기 위해서

#### 컴포넌트 기반 패키지

- 컴포넌트 내부에서 관심사의 분리는 여전히 유효하며, 업무 로직은 데이터 영속성과 분리되어 있다. 하지만 이는 컴포넌트 구현과 관련된 세부 사항으로, 사용자는 알 필요가 없다.

#### 구현 세부사항엔 항상 문제가 있다

#### 조직화 vs. 캡슐화

- 모노리틱 애플리케이션(모든 코드가 단 하나의 소스 코드 트리에 존재하는 경우) 아키텍처 원칙을 강제할 때 자기 규율이나 컴파일 후처리 도구를 이용하지 말고, 반드시 컴파일러에 의지할 것을 권장한다.
