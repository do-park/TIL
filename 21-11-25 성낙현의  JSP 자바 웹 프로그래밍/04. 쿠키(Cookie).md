# 04. 쿠키(Cookie)

### 4.1 쿠키란?

- 쿠키(Cookie)
  - 클라이언트의 상태 정보를 유지하기 위한 기술
  - 상태 정보를 클라이언트(주로 웹 브라우저)에 키(key), 값(value) 형태로 저장했다가 다음 요청 시 저장된 쿠키를 함께 전송한다. 그러면 웹 서버는 브라우저가 전송한 쿠키로부터 필요한 데이터를 읽어올 수 있다.
- 쿠키 표준(RFC 6265) 제약
  - 3000개까지 만들 수 있다.
  - 쿠키 하나의 최대 크기는 4096바이트
  - 하나의 호스트나 도메인에서 최대 50개까지 만들 수 있다.



### 4.2 기본 동작 확인

1. 동작 메커니즘
   1. 클라이언트가 서버에 요청을 보낸다.
   2. 서버가 쿠키를 생성해 HTTP 응답 헤더에 실어 클라이언트에 전송한다.
   3. 클라이언트는 쿠키를 받아 저장해둔다.
      - 이 시점에는 쿠키가 클라이언트에만 저장된 상태이므로 서버는 아직 쿠키를 사용할 수 없다.
   4. 클라이언트는 다음번 요청 시 저장해둔 쿠키를 HTTP 요청 헤더에 실어 보낸다.
   5. 서버는 쿠키의 정보를 읽어 필요한 작업을 수행한다.
2. 속성과 API
   - 속성
     - 이름(name): 쿠키를 구별하는 이름
     - 값(value): 쿠키에 저장할 실제 데이터
     - 도메인(domain): 쿠키를 적용할 도메인
     - 경로(path): 쿠키를 적용할 경로
     - 유지 기간(max age): 쿠키를 유지할 기간
   - API
     - `void setValue(String value)`
       - 쿠키의 값을 설정
       - 쉼표나 세미콜론 같은 문자는 포함할 수 없다.
     - `void setDomain(String domain)`
       - 쿠키에 적용할 도메인 설정
       - 주 도메인만 적용하고 싶다면 "도메인" 형태로 기술
       - 서브 도메인에도 적용하고 싶다면 ".도메인" 형태로 기술
     - `void setPath(String path)`
       - 쿠키가 적용될 경로를 지정
       - 지정한 경로와 그 하위 경로에까지 적용된다.
     - `void setMaxAge(int expire_seconds)`
       - 쿠키가 유지될 기간을 초 단위로 설정
       - 기간을 설정하지 않으면 웹 브라우저가 닫힐 때 쿠키도 같이 삭제된다.
     - `new Cookie(String name, String value)`
       - 이름과 값을 받아 새로운 쿠키를 생성한다.
       - setName()이 없는 이유
         - 쿠키의 이름은 생성자(constructor)를 통해 설정하고, 생성 후에는 더 이상 이름을 변경할 수 없다.
   - 쿠키 정보를 읽는 메서드
     - `String getName()`
       - 쿠키의 이름을 반환
     - `String getValue()`
       - 쿠키의 값을 반환
     - `String getDomain()`
       - 쿠키가 적용되는 도메인을 반환
     - `String getPath()`
       - 쿠키의 적용 경로를 반환
       - setPath()로 설정한 적이 없다면 null을 반환한다.
     - `int getMaxAge()`
       - 쿠키의 유지 기간을 반환
       - setMaxAge()로 설정한 적이 없다면 -1을 반환
3. 기본 조작법



### 4.3 레이어 팝업창 제어

1. 쿠키 없이 기본 기능 구현하기
2. 쿠키를 이용해 상태 정보 유지하기



### 4.4 로그인 아이디 저장

1. 편의 기능 구현하기: 자바스크립트 코드 추가
2. 편의 기능 구현하기: 쿠키 관리자
   - 쿠키를 읽을 때는 쿠키를 배열로 가져오기 때문에 반복문과 조건문이 필요하다.
   - 사용하는 쿠키가 많아진다면 조건문은 계속 복잡해질 수밖에 없다.
3. 로그인 페이지 작성하기
4. 로그인 및 아이디 저장 기능 구현하기
5. 동작 확인